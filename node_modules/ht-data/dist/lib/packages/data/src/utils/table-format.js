"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ht_utility_1 = require("ht-utility");
exports.tableFormat = function (data, config) {
    var format = config.format;
    return Object.keys(data).reduce(function (acc, key) {
        var value = data[key];
        if (typeof value === 'number' || typeof value === 'string' && !!!config.excludes.includes(key)) {
            var formatKey = format[key];
            if (formatKey) {
                var label = formatKey.label || key;
                var formattedValue = formatKey.selector(data) || value;
                acc.push([label, formattedValue]);
            }
            else {
                var label = key;
                var formattedValue = value;
                acc.push([label, formattedValue]);
            }
            return acc;
        }
        else {
            return acc;
        }
    }, []);
};
exports.actionTableFormat = {
    "assigned_at": {
        label: "Assigned at",
        selector: function (action) {
            return dateTimeString(action.assigned_at);
        }
    },
    "expected_at": {
        label: "Expected at",
        selector: function (action) {
            return action.expected_at ? dateTimeString(action.expected_at) : "--";
        }
    },
    "completed_at": {
        label: "Completed at",
        selector: function (action) {
            return dateTimeString(action.completed_at);
        }
    },
    "distance": {
        label: "Distance",
        selector: function (action) {
            return action.distance || action.distance == 0 ? ht_utility_1.DistanceLocale(action.distance) : "--";
        }
    },
    "duration": {
        label: "Duration",
        selector: function (action) {
            return action.duration || action.duration == 0 ? ht_utility_1.HMString(action.duration, 60) : "--";
        }
    },
    "scheduled_at": {
        label: "Scheduled at",
        selector: function (action) {
            return dateTimeString(action['scheduled_at']);
        }
    },
    "distance&duration": {
        label: "Distance/Duration",
        selector: function (action) {
            return exports.actionTableFormat.distance.selector(action) + "/" + exports.actionTableFormat.duration.selector(action);
        }
    }
};
exports.userTableFormat = {
    "stop_duration": {
        label: "Stop Duration",
        selector: function (user) {
            return ht_utility_1.HMString(user.stop_duration, 60);
        }
    },
    "last_heartbeat_at": {
        label: "Last updated at",
        selector: function (user) {
            return dateTimeString(user.last_heartbeat_at);
        }
    },
    "last_battery": {
        label: "Last battery",
        selector: function (user) {
            return user.display.battery + " %";
        }
    },
    "total_duration": {
        label: "Duration tracked",
        selector: function (user) {
            return ht_utility_1.HMString(user.total_duration, 60);
        }
    },
    "num_places": {
        label: "Number of stops",
        selector: function (user) {
            return user.num_places;
        }
    },
    "location_disabled_duration": {
        label: "Location disabled duration",
        selector: function (user) {
            return ht_utility_1.HMString(user.location_disabled_duration, 60);
        }
    },
    "total_distance": {
        label: "Total distance",
        selector: function (user) {
            return ht_utility_1.DistanceLocale(user.total_distance);
        }
    },
    "num_trips": {
        label: "Number of trips",
        selector: function (user) {
            return user.num_trips;
        }
    },
    "network_offline_duration": {
        label: "Network offline duration",
        selector: function (user) {
            return ht_utility_1.HMString(user.network_offline_duration, 60);
        }
    },
    "num_actions": {
        label: "Number of actions",
        selector: function (user) {
            return user.num_actions;
        }
    }
};
function dateTimeString(time) {
    return time ? ht_utility_1.TimeString(time) + ", " + ht_utility_1.DateString(time, 'short') : "--";
}
//# sourceMappingURL=table-format.js.map